# generated: 2025-12-07
# System Auto: last updated on: 2025-12-24T13:26:31
# HAIOS Backlog

> **DEPRECATED AS SOURCE OF TRUTH (Session 111)**
>
> Work files (`docs/work/active/WORK-*.md`) are now the project management source of truth per ADR-039.
> This file is retained for **reference only** - use it to double-check work item details since the E2-151 migration wasn't perfect (some content may be richer here than in work files).
>
> **Do NOT edit this file for status updates.** Use `/close` command to close work items.

> **Last Synced to Memory:** Pending initial sync
> **Active Items:** See haios-status.json (auto-derived)
> **Archived Items:** See `backlog_archive.md` (15 completed items moved 2025-12-22)

---

## Epoch 2: Governance Suite

### [MEDIUM] E2-004: Documentation Sync
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-07
- **Context:** Update epistemic_state.md, CLAUDE.md, hooks README to reflect Session 38 changes

### [LOW] E2-016: Enhanced CLI Status + Synthesis Run
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-08
- **Session:** 49
- **Context:** Session 49 troubleshooting revealed table name assumptions. CLI status should be single source of truth.
- **Root Cause:** Assumed `clusters` table, actual name is `synthesis_clusters`. Should have checked schema first.
- **Unblocked By:** E2-FIX-004 (Session 88) - Synthesis now progresses through full concept space. Running synthesis with higher limits will now actually cover new concepts instead of re-processing the same 6,765.
- **Deliverables:**
  - [ ] Add synthesis stats to `cli.py status` command (clusters, members, last run)
  - [ ] Run synthesis with `--max-bridges 200` (double default) to connect E2-015 learnings
- **Pattern:** "Make right way easy" - one command shows all DB state, no guessing

### [HIGH] E2-017: Concept Embedding Completion
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-09
- **Session:** 50
- **Context:** 4,933 concepts (7.6%) have no embeddings - cannot be found via semantic search.
- **Update (Session 88):** Gap reduced to 4.6% (3,336/72,731). Notable: `techne` type has 0% embeddings (135 concepts).
- **Evidence:**
  - 64,640 total concepts (stale - now 72,731)
  - 59,707 concept embeddings (stale - now 69,395 = 95.4% coverage)
  - Silent retrieval failure - queries miss 4.6% of knowledge
- **Deliverables:**
  - [ ] Identify which concepts lack embeddings (by type, content length, creation date)
  - [ ] Run embedding completion script
  - [ ] Verify 100% coverage
- **Memory:** Concepts 64641-64652 (Session 50 investigation)

### [MEDIUM] E2-018: Entity Embedding Generation
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-09
- **Session:** 50
- **Context:** 0/8,006 entities have embeddings - entities invisible to semantic search.
- **Impact:** Cannot query "who worked on X" or "what files relate to Y"
- **Deliverables:**
  - [ ] Add entity embedding generation to ETL pipeline
  - [ ] Generate embeddings for existing entities
  - [ ] Verify entity retrieval works
- **Memory:** Concepts 64641-64652

### [MEDIUM] E2-019: Concept Type Normalization
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-09
- **Session:** 50
- **Context:** 110+ distinct concept types, many duplicates/variants.
- **Evidence:**
  - Major: Critique (23k), Directive (21k), Proposal (12k), Decision (4k)
  - Variants: "Process description" vs "Process Description" vs "Process"
  - One-offs: "ML Paradigm" (1), "Visuals" (2), "Topic" (2)
- **Impact:** Inconsistent classification hurts retrieval and synthesis
- **Deliverables:**
  - [ ] Define canonical type set (Greek Triad + LangExtract core types)
  - [ ] Create migration to normalize existing concepts
  - [ ] Update extraction to use canonical types
- **Memory:** Concepts 64641-64652

### [HIGH] E2-024: Dependency Integrity Validator
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-09
- **Session:** 51
- **Context:** Governance mechanisms reference other artifacts (hooks -> subagents -> skills -> commands). No validation these exist.
- **Problem:** If `schema-verifier.md` deleted, PreToolUse still blocks SQL saying "use schema-verifier" - broken UX.
- **Gaps Identified:**
  - Hook references non-existent subagent
  - Subagent references non-existent skill
  - Hook suggests non-existent command
  - Plan references non-existent backlog_id
  - Backlog-Plan status sync drift
  - Backlog items without memory refs
- **Solution:** Dependency validator that checks cross-reference integrity
- **Deliverables:**
  - [ ] `ValidateDependencies.ps1` - checks hooks/subagents/skills/commands exist
  - [ ] Integration with `/status` command - surface broken references
  - [ ] UserPromptSubmit hook warning on integrity issues
- **Memory:** Concepts 64736-64751

### [HIGH] E2-025: PreCompact Hook - Context Preservation
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-09
- **Session:** 51
- **Context:** Compact is a black box. Happens, context shrinks, continuity breaks. Operator has to re-explain.
- **Problem:**
  - Don't know what triggers compact
  - Don't know what survives vs discarded
  - No control over what's preserved
  - Post-compact agent forgets decisions, context, progress
- **Opportunity:** PreCompact hook fires BEFORE compact
- **Potential Actions:**
  - [ ] Extract key learnings to memory before lost
  - [ ] Auto-create mini-checkpoint with session decisions
  - [ ] Store "session did X, Y, Z" summary
  - [ ] Flag in-progress work for post-compact pickup
  - [ ] Investigate: can we influence what compact preserves?
- **Research Questions:**
  - What token threshold triggers compact?
  - Is the summary algorithm controllable?
  - Can we inject "must preserve" markers?
- **Goal:** Maximize compact value, minimize continuity loss
- **Memory:** Concepts 64752-64765

### [MEDIUM] E2-029: /new-backlog-item Command
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-10
- **Session:** 56
- **Context:** No governed path for backlog item creation. Items added manually with inconsistent format.
- **Problem:** backlog_item template has the most constrained fields (status, priority, complexity, category) but no command to scaffold it.
- **Solution:**
  - [ ] Create `/new-backlog-item` command with argument parsing
  - [ ] Template scaffold with correct frontmatter
  - [ ] Prompt agent for required fields (priority, category, complexity)
  - [ ] Optionally prompt for memory_refs (ties to E2-021)
- **Allowed Values to Document:**
  - status: proposed, researching, ready, implementing, cancelled, completed
  - priority: critical, high, medium, low
  - complexity: small, medium, large, unknown
  - category: enhancement, technical_debt, bug, research, documentation
- **Related:** E2-021 (Memory Reference Governance), E2-030 (Template Review)

### [MEDIUM] E2-035: Checkpoint Lifecycle Enhancement
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-13
- **Session:** 64, 65
- **Spawned By:** Session 64 observation
- **Partially Subsumed By:** E2-037 (RFC 2119 Governance Signaling) - Session 65
- **Context:** When bugs/gaps discovered during verification, checkpoint captures "continuation instructions" but doesn't spawn proper lifecycle artifacts.
- **Problem:**
  - Session 63: Ingester embedding gap discovered during morning verification
  - Checkpoint noted "fix ingester.py" in continuation instructions
  - No E2-FIX-002 spawned, no investigation created
  - Agent (Session 64) attempted to proceed without lifecycle artifacts
- **Pattern Gap:** Discovery-during-verification should spawn work items, not just notes.
- **Session 65 Insight:** E2-037 addresses the SIGNAL problem (MUST spawn work items on discovery). E2-035 addresses the MECHANISM problem (template changes, prompts). E2-035 becomes an implementation task for E2-037's checkpoint-specific signals.
- **Enhancement Scope (Revised - E2-037 absorbs signal, E2-035 keeps mechanism):**
  - [x] Document pattern: "Discovery spawns backlog items" → MOVED to E2-037 (MUST /new-investigation)
  - [ ] Checkpoint template: Add "Spawned Work Items" section
  - [ ] /new-checkpoint prompt: "Did this session discover issues that need new backlog items?"
  - [ ] Optional: /close enhancement - when closing item, prompt for discovered follow-up items
- **Effort:** Low (1 session - scope reduced by E2-037)
- **Related:** E2-037 (provides governance signal framework), E2-033 (Cascade Unblock), E2-023 (/close command)

### [HIGH] E2-037: RFC 2119 Governance Signaling System
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-13
- **Session:** 65
- **Spawned By:** Session 65 strategic analysis (HAIOS Song Ontology)
- **Context:** Session 65 discovered fundamental gap: work events (discoveries, decisions) don't automatically spawn artifacts (investigations, ADRs, plans).
- **Discovery:** Two parallel tracks exist:
  1. **Work Track** (ephemeral): discover → design → plan → implement → verify
  2. **Artifact Track** (persistent): INVESTIGATION → ADR → PLAN → CHECKPOINT → REPORT
  - No bridge connects them. Manual only.
- **Proposed Solution:** RFC 2119 signaling - use MUST/SHOULD/MAY to guide Claude toward proper commands/skills/agents at the right moments.
- **Key Insight:** Hooks can't see semantic events (discoveries happen in Claude's reasoning). Signal-based guidance leverages Claude's understanding instead of fighting hook limitations.
- **ADR:** ADR-035 (pending)
- **Memory:** Concepts 70904-70939 (HAIOS Song Ontology)
- **Implementation Scope:**
  - [ ] ADR-035: Document decision and rationale
  - [ ] CLAUDE.md: Add governance triggers table (MUST/SHOULD/MAY)
  - [ ] UserPromptSubmit enhancement: Keyword detection → reminder injection
  - [ ] Define event taxonomy (canonical work events)
  - [ ] Test compliance over 5 sessions
  - [ ] **Phase 5 (Session 80):** Add "SHOULD review unblocked plans before starting" trigger
- **Effort:** Medium (2-3 sessions)
- **Related:** E2-034 (Cold Start), E2-035 (Checkpoint Lifecycle), E2-036 (Regex Fix)

### [HIGH] E2-021: Memory Reference Governance + Rhythm
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-09
- **Session:** 50, 65
- **Complements:** E2-037 (RFC 2119 Governance Signaling) - Session 65
- **Context:** Backlog items inconsistently link to memory concepts. No closed learning loop.
- **Session 65 Insight:** E2-021 already uses MUST language ("Investigations MUST produce memory references"). E2-037 provides the framework for MUST/SHOULD/MAY governance signals. E2-021 is an APPLICATION of that framework for memory-specific rules.
- **Vision:** APIP Memory Linkage Pattern
  - Investigations MUST produce memory references (via `ingester_ingest`) - E2-037 signal
  - Backlog items from investigations MUST link to those references - E2-037 signal
  - Future work queries memory for context on pending items
  - Closed loop: Investigation -> Memory -> Backlog -> Implementation -> Memory
- **Solution A - Governance (via E2-037 framework):**
  - [ ] Add memory-specific MUST/SHOULD rules to CLAUDE.md governance triggers (E2-037 Phase 1)
  - [ ] Add `memory_refs` field to backlog_item template
  - [ ] PreToolUse hook validates memory_refs on backlog.md edits (warn, not block)
  - [ ] `/new-backlog-item` command that prompts for memory references
- **Solution B - Rhythm:**
  - [ ] Weekly review cycle: query memory for stale/unlinked concepts
  - [ ] `/memory-audit` command: surfaces backlog items without memory refs
  - [ ] Integration with `/workspace`: show memory coverage stats
- **Success Criteria:**
  - 100% of investigation-derived items have memory_refs
  - Memory can answer "what work relates to concept X?"
  - Backlog can answer "what memory supports item Y?"
- **Memory:** Concepts 64653-64669 (Session 50 design decisions)
- **Related:** E2-037 (provides governance signal framework)

### [HIGH] E2-072: Critique Subagent (Assumption Surfacing)
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-14
- **Session:** 74
- **Spawned By:** Session 74 - critique of E2-063 design revealed value of structured assumption surfacing
- **Context:** Design decisions contain implicit assumptions. Main agent has cognitive bias (sunk cost, confirmation). Isolated critique agent can provide unbiased analysis.
- **Problem:**
  - PLAN-E2-063 was missing key design details (prompt, thresholds, rationale)
  - Only surfaced through manual critique dialogue
  - Main agent unlikely to critique own design rigorously
- **Solution:** Dedicated critique subagent running in isolated context:
  - Input: Design artifact (function spec, plan section, ADR decision)
  - Framework: Assumption Surfacing (identify beliefs, stress-test, propose mitigations)
  - Output: List of assumptions with status (accept/revise/investigate)
  - Isolation: Separate context window = no sunk cost bias
- **Deliverables:**
  - [ ] Create `.claude/agents/critic.md` subagent definition
  - [ ] Define critique framework (Assumption Surfacing as default)
  - [ ] Create `/critique <artifact>` command or skill invocation
  - [ ] Test on 3 existing designs, validate improvement
- **Success Criteria:**
  - Critique identifies assumptions main agent missed
  - Recommendations lead to design improvements
  - Process takes <5 minutes per artifact
- **Effort:** Medium (1-2 sessions)
- **Related:** E2-037 (governance triggers - SHOULD critique before implement), Plan template (now has Detailed Design section)

### [LOW] TD-001: TOON Serializer
- **Status:** pending
- **Owner:** Open
- **Created:** 2025-12-04
- **Context:** Implement 57% token savings format for memory output

### [LOW] TD-002: Validation Agent Prototype
- **Status:** pending
- **Owner:** Open
- **Created:** 2025-12-04
- **Context:** TRD ready (TRD-VALIDATION-AGENT-v1.md), needs implementation

### [LOW] TD-003: Multi-Index Architecture
- **Status:** pending
- **Owner:** Open
- **Created:** 2025-12-04
- **Context:** Graph + Summary indices for advanced retrieval

---

## Verification (Deferred - Not Blocking)

### [LOW] V-001: Governance Effectiveness Validation
- **Status:** pending
- **Owner:** Open
- **Created:** 2025-12-07 (Session 40)
- **Context:** Verify governance actually changes behavior vs ceremony. Current state: Level 2 (Guidance), not Level 3 (Enforcement).
- **Memory:** Concept 62539
- **Verification Tasks:**
  - [ ] Test PreToolUse enforcement (intentionally try raw Write)
  - [ ] Sample 10 extracted strategies, rate quality
  - [ ] Scan all .md files for template compliance rate
  - [ ] Review alignment_issues from UpdateHaiosStatus.ps1
- **Decision:** Not a blocker. Gaps are verification, not capability.

---

## Investigations

### [HIGH] E2-028: Greek Triad Classification Gap
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-10
- **Session:** 55
- **Related:** E2-019 (Type Normalization), INV-003 (Quality Audit)
- **Context:** Greek Triad (episteme/techne/doxa) barely used - 39 concepts total vs 64,971 using extraction types.
- **Evidence (Session 55):**
  - episteme: 14 (0.02%)
  - techne: 25 (0.04%)
  - doxa: 0 (0%)
  - Critique/Directive/Proposal/Decision: 61,325 (94.4%)
- **Problem:**
  - Triad was designed for knowledge classification (facts vs skills vs beliefs)
  - Extraction types describe rhetorical function, not knowledge type
  - Cannot query "show me opinions" or "show me verified facts"
  - Doxa category entirely empty - no belief/opinion tracking
- **Investigation Questions:**
  - Was Triad added late (after bulk extraction)?
  - Can extraction types map to Triad? (Critique → doxa? Decision → episteme?)
  - What should be doxa? (Hypotheses, preferences, unverified claims)
  - Should ingester_ingest auto-classify existing types to Triad?
- **Key Insight:** Extraction types and Triad are ORTHOGONAL, not competing:
  - Extraction type = rhetorical function (What is this saying?)
  - Triad = knowledge category (How certain is this?)
  - A concept can be `type: Directive, knowledge_class: techne` (a how-to instruction)
  - A concept can be `type: Critique, knowledge_class: doxa` (an opinion-based evaluation)
  - A concept can be `type: Decision, knowledge_class: episteme` (a verified fact chosen)
- **Use Case:** Dual classification enables richer queries:
  - "Show me all techne" (how-to knowledge, regardless of rhetorical form)
  - "Show me doxa about architecture" (opinions, for critical review)
  - "Show me episteme Decisions" (verified facts that were decided)
- **Deliverables:**
  - [ ] Timeline analysis: when was Triad introduced vs bulk extraction
  - [ ] Schema update: add `knowledge_class` column (episteme/techne/doxa)
  - [ ] Mapping heuristics: can extraction types inform Triad? (Critique often → doxa)
  - [ ] Doxa identification: what content qualifies as belief/opinion
  - [ ] Migration plan: backfill existing concepts with knowledge_class
  - [ ] Ingester update: auto-classify knowledge_class on ingest
- **Memory:** Session 55 discovery (concepts 64974-64992)

### [HIGH] INV-025: Workflow State Machine Architecture
- **Status:** active
- **Priority:** high
- **Owner:** Hephaestus
- **Created:** 2025-12-14
- **Session:** 71
- **Note:** Renamed from INV-012 (Session 102) due to ID collision with INV-012-static-registration
- **Context:** Commands and skills should chain together forming a workflow state machine. Commands = state transitions, Skills = states with defined exits, Exits = controlled pathways to other commands.
- **Investigation:** `docs/investigations/INVESTIGATION-INV-025-workflow-state-machine-architecture.md`
- **Related:** INV-011 (prerequisite), INV-010 (context issue), INV-022 (Work-Cycle-DAG - supersedes parts)
- **Key Insight:** "Strike skills and commands together - command opens skill that has exits via another command, lock in full loops or limit forks to controlled pathways"
- **Spawned Work (pending):** ADR-039, E2-052, E2-053, E2-054

### [HIGH] INV-014: Memory Context Injection Architecture
- **Status:** active
- **Priority:** high
- **Owner:** Hephaestus
- **Created:** 2025-12-14
- **Session:** 72
- **Spawned By:** INV-010
- **Context:** Memory context injected via UserPromptSubmit hook has multiple issues: truncated mid-sentence, meta-level strategies (about searching not domain), semicolon formatting, and NOT using ADR-037 mode parameter.
- **Investigation:** `docs/investigations/INVESTIGATION-INV-014-memory-context-injection-architecture.md`
- **Hypotheses (4 CONFIRMED, 1 LIKELY):**
  - H1 CONFIRMED: Truncation hardcoded at 150 chars
  - H2 CONFIRMED: ADR-037 mode not passed to retrieval
  - H3 LIKELY: Strategies are meta-level, not domain-relevant
  - H4 CONFIRMED: No type filtering in injection
  - H5 CONFIRMED: TOON semicolon replacement hurts readability
- **Quick Wins:** Add mode='session_recovery', increase truncation limit
- **Spawned Work:** E2-059, E2-060, E2-061, E2-062
- **Related:** INV-010, ADR-037

### [HIGH] INV-015: Retrieval Algorithm Intelligence
- **Status:** active
- **Priority:** high
- **Owner:** Hephaestus
- **Created:** 2025-12-14
- **Session:** 73
- **Spawned By:** Session 73 operator feedback
- **Context:** E2-059 proved mechanism works (input/output pipeline), but algorithm is naive. Pure cosine similarity with no contextual understanding. Operator: "the mechanism input output is there, the algorithm is lacking."
- **Investigation:** `docs/investigations/INVESTIGATION-INV-015-retrieval-algorithm-intelligence.md`
- **Hypotheses:**
  - H1: Raw prompts are poor queries (conversational != semantic)
  - H2: Pure similarity misses contextual relevance
  - H3: Strategies matched by pattern, not task applicability
  - H4: Results dumped without actionable framing
  - H5: No feedback loop on retrieval usefulness
- **Scope:** Query formulation, ranking algorithms, task-type awareness, applicability scoring
- **Related:** INV-010 (CLOSED), INV-014, ADR-037

### [HIGH] INV-016: HAIOS Operational Infrastructure Audit
- **Status:** active
- **Priority:** high
- **Owner:** Hephaestus
- **Created:** 2025-12-14
- **Session:** 75
- **Spawned By:** Session 75 operator strategic review
- **Context:** Comprehensive audit of HAIOS operational infrastructure - haios-status.json, commands, skills, hooks, agents, MCP tools, documentation. Design mechanical roadmap and HAIOS Song architecture.
- **Investigation:** `docs/investigations/INVESTIGATION-INV-016-haios-operational-infrastructure-audit.md`
- **Hypotheses:**
  - H1: haios-status.json live_files not actionable (no age, no progression)
  - H2: Commands are prompts not automation
  - H3: Skills lack invocation context
  - H4: Hooks fire but outcomes not measured
  - H5: Agents under-documented
  - H6: MCP tools lack usage guidance
  - H7: Documentation doesn't change behavior (ceremony)
- **Scope:** Audit infrastructure utility, design roadmap structure, map HAIOS Song architecture
- **Related:** INV-011, INV-012, INV-014, INV-015, E2-069, E2-024, E2-025, E2-034

### [HIGH] INV-017: Observability Gap Analysis
- **Status:** active
- **Priority:** high
- **Owner:** Hephaestus
- **Created:** 2025-12-19
- **Session:** 86
- **Spawned By:** Session 86 meta-question ("how is our system performing?")
- **Investigation:** `docs/investigations/INVESTIGATION-INV-017-observability-gap-analysis.md`
- **Context:** Audit of HAIOS observability infrastructure. What telemetry exists? What gaps exist in anomaly detection? Is observability investment valuable at current scale?
- **Hypotheses (ALL CONFIRMED):**
  - H1: ErrorCapture hook wired but no dedicated error type in memory
  - H2: Heartbeat scheduler (E2-081) designed but not executing
  - H3: ReasoningBank captures failure occurrence but not failure reasons
  - H4: Current observability adequate for single-operator development phase
- **Findings:**
  - 96% embedding coverage (healthy)
  - 1,501 reasoning traces (57% success, 42% partial, <1% failure)
  - Only 1 heartbeat event vs 26 cascades (scheduler not running)
  - 7 failures in reasoning_traces all have `failure_reason = NULL`
- **Spawned Work:** E2-102, E2-103, E2-104
- **Related:** E2-081, E2-007, E2-084, ADR-037

---

## Implementation Work



### [HIGH] E2-076: DAG Governance Architecture ADR
- **Status:** pending
- **Priority:** high
- **Owner:** Hephaestus
- **Created:** 2025-12-14
- **Session:** 75
- **Spawned By:** INV-016
- **Context:** Formalize DAG architecture where documents=nodes, dependencies=edges, hooks trigger cascading updates. Progressive context loading (vitals -> slim -> full). HAIOS Song metaphor made mechanical.
- **Plan:** `docs/plans/PLAN-E2-076-dag-governance-architecture-adr.md`
- **Subplans:** (to be created)
  - E2-076a: ADR-038 authoring
  - E2-076b: Frontmatter schema + ValidateTemplate
  - E2-076c: haios-status-slim.json (merges E2-074)
  - E2-076d: Vitals injection (UserPromptSubmit)
  - E2-076e: Cascade hooks
- **Memory:** 50372, 50388, 71375 (DAG concepts)
- **Related:** E2-069, E2-074, E2-037, INV-011, INV-012, INV-016

### [LOW] E2-075: HAIOS Song Documentation Alignment
- **Status:** pending
- **Priority:** low
- **Owner:** Hephaestus
- **Created:** 2025-12-14
- **Session:** 75
- **Spawned By:** INV-016
- **Context:** Mental model mismatch. Code moves to "Song" metaphor, documentation must follow.
- **Deliverables:**
  - [ ] Update `README.md` with Keys/Chords/Strings metaphor
  - [ ] Create `docs/architecture/HAIOS-SONG.md` reference
  - [ ] Update `docs/epistemic_state.md` to reflect new architecture
- **Memory:** Concept 75003 (Metaphor Alignment)

### [LOW] E2-068: Async Query Rewriting Investigation
- **Status:** pending
- **Priority:** low
- **Owner:** Hephaestus
- **Created:** 2025-12-14
- **Session:** 73
- **Spawned By:** E2-063
- **Context:** Investigate parallelizing query rewriting with other hook work for latency reduction.
- **Related:** E2-063

---

## Project Management Enhancement

### [HIGH] E2-069: Roadmap and Milestones Structure
- **Status:** pending
- **Priority:** high
- **Owner:** Hephaestus
- **Created:** 2025-12-14
- **Session:** 73, 75
- **Enhanced By:** INV-016 (Session 75)
- **Context:** PM system lacks roadmap with milestones. Work feels unmoored. Need hierarchical structure: North Star > Milestones > Items.
- **Deliverables:**
  - [ ] Create `docs/pm/north_star.md` template and file
  - [ ] Create `docs/pm/milestones/` directory and M1/M2 files
  - [ ] Link existing backlog items to milestones
  - [ ] Update `haios-status.json` with milestone tracking logic
  - [ ] Update `/workspace` to show milestone progress
- **Memory:** Concept 75001 (Roadmap Design)

### [LOW] E2-071: Milestone Progress Visualization
- **Status:** pending
- **Priority:** low
- **Owner:** Hephaestus
- **Created:** 2025-12-14
- **Session:** 73
- **Spawned By:** E2-069
- **Blocked By:** E2-076d (Vitals Injection calculates milestone %)
- **Context:** Visual progress tracking - percentage complete per milestone, burndown-style tracking.
- **Note (Session 78):** E2-076d implements milestone % calculation in vitals. E2-071 extends to burndown/visualization.
- **Related:** E2-069, E2-076d

---

## Memory & Schema Infrastructure

### [MEDIUM] E2-077: Schema-Verifier Skill Wrapper
- **Status:** pending
- **Priority:** medium
- **Owner:** Hephaestus
- **Created:** 2025-12-15
- **Session:** 76
- **Context:** Schema-verifier subagent works but agents don't know correct column names before querying. Example: queried `content_type='bridge_insight'` when actual schema is `type='SynthesizedInsight'`.
- **Problem:** Subagent isolates context but doesn't teach calling agent the schema vocabulary.
- **Solution:** Wrap schema-verifier in a skill that:
  1. Injects schema vocabulary hints before query
  2. Shows common column name mappings (content_type vs type)
  3. Returns query results WITH schema context for future queries
- **Deliverables:**
  - [ ] Create `.claude/skills/schema-query/SKILL.md`
  - [ ] Skill loads schema summary (table→columns→types)
  - [ ] Skill invokes schema-verifier subagent
  - [ ] Skill formats response with "for future reference" schema hints
- **Pattern:** "Make right way easy" - agent learns schema vocabulary through use
- **Related:** E2-020 (Schema Discovery), schema-verifier subagent


### [MEDIUM] E2-079: CLAUDE.md De-bloat (Progressive Static Context)
- **Status:** pending
- **Priority:** medium
- **Owner:** Hephaestus
- **Created:** 2025-12-15
- **Session:** 76
- **Parent:** E2-076 (DAG Governance)
- **Spawned By:** E2-076
- **Context:** CLAUDE.md has grown large (~500+ lines). Much content is reference material that could live elsewhere, loaded on-demand.
- **Problem:** Every session loads full CLAUDE.md - token overhead for rarely-used sections.
- **Why This Belongs to E2-076:** Implements the L1→L4 progressive context philosophy for static files, complementing E2-076d's runtime injection tiers.
- **Solution:** Split CLAUDE.md into:
  1. **L1 Core** (~150 lines): Identity, critical rules, governance triggers
  2. **L3 Reference** (on-demand): Full command list, troubleshooting, detailed patterns
- **Deliverables:**
  - [ ] Audit CLAUDE.md sections by usage frequency
  - [ ] Identify "always needed" vs "reference lookup" content
  - [ ] Create `.claude/REFS/` directory for reference docs
  - [ ] Slim CLAUDE.md to essentials (~150 lines)
  - [ ] Update coldstart to surface refs availability
- **Pattern:** Progressive disclosure - mirrors E2-076d L1/L2/L3/L4 tiers for static content
- **Related:** [E2-076, E2-076d, E2-078]

---

## Symphony Architecture (Session 78)

> **Vision:** Move from "orchestra warming up" to "first movement" - rhythmic pulse, dynamic thresholds, proactive awareness, event resonance.
> **Spawned By:** Session 78 design discussion
> **Parent:** E2-076 family (DAG Governance provides the sheet music, Symphony provides the conductor)

### [HIGH] E2-081: Heartbeat Scheduler (RHYTHM)
- **Status:** pending
- **Priority:** high
- **Owner:** Hephaestus
- **Created:** 2025-12-16
- **Session:** 78
- **Spawned By:** Session 78 symphony design
- **Blocked By:** E2-080 (Justfile - COMPLETE)
- **Context:** Claude is reactive - responds to prompts, can't initiate. Symphony needs rhythm. External scheduler provides pulse.
- **Approach:** SOURCE existing (don't build scheduler)
- **Architecture:**
  ```
  Windows Task Scheduler (hourly)
      │
      ▼
  just heartbeat
      │
      ├── python -m haios_etl.cli synthesis run --quiet
      ├── just update-status
      └── Append event to haios-events.jsonl
  ```
- **Deliverables:**
  - [ ] Add `just heartbeat` recipe to justfile
  - [ ] Create Windows Task Scheduler task (hourly)
  - [ ] Heartbeat appends to `.claude/haios-events.jsonl`
  - [ ] Document: "System has pulse even without operator"
- **Pattern:** External rhythm compensates for Claude's reactive nature
- **Effort:** 30 min
- **Related:** [E2-080, E2-084, E2-076]

### [MEDIUM] E2-082: Dynamic Thresholds (DYNAMICS)
- **Status:** pending
- **Priority:** medium
- **Owner:** Hephaestus
- **Created:** 2025-12-16
- **Session:** 78
- **Spawned By:** Session 78 symphony design
- **Blocked By:** E2-076d (Vitals must exist to inject threshold messages)
- **Context:** Milestones are flat checkboxes (75%... 76%...). Symphony needs crescendo - building intensity as completion approaches.
- **Approach:** BUILD simple (20 lines in hook, no library)
- **Architecture:**
  ```
  UserPromptSubmit.ps1
      │
      ├── Read milestone.progress from haios-status.json
      │
      ├── if (progress > 90%):
      │       inject "APPROACHING: M2-Governance at 92%"
      │
      ├── if (stale_count > 5):
      │       inject "ATTENTION: 6 stale items need review"
      │
      └── if (blocked_items > 3):
              inject "BOTTLENECK: 4 items blocked"
  ```
- **Deliverables:**
  - [ ] Add threshold logic to UserPromptSubmit.ps1 (after vitals)
  - [ ] Thresholds: milestone > 90%, stale > 5, blocked > 3
  - [ ] Messages: APPROACHING, ATTENTION, BOTTLENECK prefixes
  - [ ] Test: artificially set milestone to 95%, verify message
- **Pattern:** Dynamics emerge from state awareness, not complex logic
- **Effort:** 1 hour
- **Related:** [E2-076d, E2-076e, E2-071]


### [MEDIUM] E2-084: Event Log Foundation (RESONANCE)
- **Status:** pending
- **Priority:** medium
- **Owner:** Hephaestus
- **Created:** 2025-12-16
- **Session:** 78
- **Spawned By:** Session 78 symphony design
- **Blocked By:** E2-076e (Cascade writes events)
- **Context:** Events happen but aren't recorded. Can't ask "what happened yesterday?" or detect compound effects. Symphony needs resonance - events that echo and amplify.
- **Approach:** BUILD minimal (append-only .jsonl, no library)
- **Architecture:**
  ```
  .claude/haios-events.jsonl (append-only)

  {"ts":"2025-12-16T17:00:00","type":"cascade","source":"E2-076d","effects":["unblock:E2-076e"]}
  {"ts":"2025-12-16T17:01:00","type":"milestone","source":"M2","old":78,"new":80}
  {"ts":"2025-12-16T18:00:00","type":"heartbeat","synthesis_run":true,"new_bridges":5}
  {"ts":"2025-12-16T19:30:00","type":"session","action":"start","checkpoint":"SESSION-78"}
  ```
- **Deliverables:**
  - [ ] Create `.claude/haios-events.jsonl` (empty, append-only)
  - [ ] CascadeHook.ps1 appends cascade events
  - [ ] Heartbeat appends heartbeat events
  - [ ] Add `just events` recipe (tail -20 haios-events.jsonl)
  - [ ] Add `just events-since <date>` for filtered view
- **Pattern:** Event log enables future resonance detection (compound effects)
- **Future:** E2-085+ could analyze event patterns for "momentum" detection
- **Effort:** 30 min
- **Related:** [E2-076e, E2-081, E2-082]

### [MEDIUM] E2-086: Template RFC 2119 Normalization
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-16
- **Session:** 80
- **Context:** Templates should guide agents with explicit RFC 2119 governance signals. Currently templates have placeholders but lack MUST/SHOULD/MAY guidance sections.
- **Spawned By:** Session 80 discussion - "review unblocked plans" pattern should be systematized
- **Scope:**
  - [ ] `checkpoint.md` - Add "Session Hygiene" with SHOULD items (e.g., SHOULD review unblocked plans)
  - [ ] `implementation_plan.md` - Add "Pre-Implementation Checklist" with MUST items
  - [ ] `investigation.md` - Add "Discovery Protocol" with SHOULD items
  - [ ] `report.md` - Add "Verification Requirements" with MUST items
  - [ ] `architecture_decision_record.md` - Add "Decision Criteria" with MUST items
- **Pattern:** Each template gets "Governance Guidance" section with tiered requirements
- **Effort:** Low (1 session - mechanical template updates)
- **Related:** [E2-037 (RFC 2119 framework), E2-076b (Frontmatter Schema), ADR-035]

### [LOW] E2-087: Plan Forward-Maintenance Automation
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-16
- **Session:** 80
- **Context:** When plans become unblocked, they may be stale relative to recent work. Session 80 manually reviewed E2-076e after E2-076d completion, found gaps (event logging, leverage notes).
- **Spawned By:** Session 80 process insight
- **Scope:**
  - [ ] Add staleness detection to cascade (sessions since last update)
  - [ ] Surface "Review Prompt" in cascade message for stale unblocked plans
  - [ ] Add `last_reviewed_session` field to plan frontmatter
- **Deferred:** Low priority - manual review works, automation is nice-to-have
- **Effort:** Low (1 session)
- **Related:** [E2-076e (Cascade), E2-037 Phase 5]

### [LOW] E2-088: Epistemic State Slim-Down
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-16
- **Session:** 81
- **Context:** `docs/epistemic_state.md` has stale sections (Unknowns last updated Session 58, Mitigation duplicates CLAUDE.md). Only anti-patterns section provides unique value.
- **Problem:** File is loaded at coldstart but 70% is cruft. Unknowns aren't auto-updated, Recently Surfaced is frozen.
- **Solution:** Rename to `anti-patterns.md`, keep only behavioral patterns table, delete rest.
- **Deliverables:**
  - [ ] Rename `epistemic_state.md` -> `anti-patterns.md`
  - [ ] Delete stale sections (Unknowns, Recently Surfaced, Mitigation Mechanisms)
  - [ ] Update `/coldstart` to load `anti-patterns.md`
  - [ ] Update CLAUDE.md references
- **Pattern:** Slim context - only load what's actively maintained
- **Effort:** Low (30 min)
- **Related:** [E2-079 (CLAUDE.md De-bloat), E2-076 (Progressive Context)]

### [MEDIUM] E2-090: Script-to-Skill Migration
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-16
- **Session:** 81
- **Context:** Scripts created during E2-084 (plan_tree.py) violate INV-011 architecture. Commands should invoke skills, skills should call just recipes.
- **Architectural Pattern:**
  ```
  /tree command → plan-tree skill → just tree recipe
       ↓              ↓                   ↓
     prompt       pattern+exits      execution
  ```
- **Migration Candidates:**
  - [ ] `just tree` / `just ready` → `/tree` command + `plan-tree` skill
  - [ ] `just cascade` → `/cascade` command (or fold into `/close`)
  - [ ] `just events*` → `/events` command + `events` skill
  - [ ] `just session-start/end` → auto-invoke from commands (no direct user call)
- **Related:** INV-011 (Command-Skill Architecture Gap), INV-025 (Workflow State Machine)
- **Effort:** Medium (1 session)

### [LOW] E2-089: Fix backlog_ids Array Parsing Bug
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-16
- **Session:** 81
- **Context:** `UpdateHaiosStatus.ps1` parses `backlog_id: E2-001` but checkpoints use `backlog_ids: [E2-076d, E2-081, ...]`. Array syntax not matched, all checkpoints show `backlog_id: null` in haios-status.json.
- **Root Cause:** Line 223 regex `backlog_id:\s*(E2-[A-Z]*-?\d{3})` only matches singular.
- **Fix:**
  ```powershell
  # Try plural array first, fall back to singular
  $backlogIds = if ($yaml -match 'backlog_ids:\s*\[([^\]]+)\]') {
      $Matches[1] -split ',\s*' | ForEach-Object { $_.Trim() }
  } elseif ($yaml -match 'backlog_id:\s*(\S+)') {
      @($Matches[1].Trim())
  } else { @() }
  ```
- **Deliverables:**
  - [ ] Update regex to handle `backlog_ids: [array]` syntax
  - [ ] Store as array (first item for backward compat, or all)
  - [ ] Verify checkpoints now show correct backlog_ids in haios-status.json
- **Effort:** Low (30 min)
- **Related:** [E2-076b (Frontmatter Schema), E2-015 (Lifecycle ID)]

---

## Observability (Session 86)

> **Spawned By:** INV-017 (Observability Gap Analysis)
> **Theme:** Low-cost wins to improve system health visibility

### [MEDIUM] E2-112: Investigation Agent
- **Status:** proposed
- **Owner:** Hephaestus
- **Created:** 2025-12-20
- **Session:** 89
- **Milestone:** M4-Research
- **blocked_by:** [E2-111]
- **Context:** Context-isolated agent for research. Like memory-agent pattern.
- **Effort:** Medium

### [LOW] E2-114: Spawn Tree Query
- **Status:** ready
- **Owner:** Hephaestus
- **Created:** 2025-12-20
- **Session:** 89
- **Milestone:** M4-Research
- **Context:** `just spawns <id>` recipe to visualize what investigations produced.
- **Effort:** Small
- **Note:** E2-110 blocker resolved (complete) - Session 97

### [SMALL] E2-132: Remove @ References from Checkpoint Template
- **Status:** proposed
- **Owner:** Hephaestus
- **Created:** 2025-12-22
- **Session:** 100
- **spawned_by:** E2-116
- **Context:** E2-116 investigation confirmed @ references in checkpoints are purely ceremonial - Claude Code does not process @ symbols in saved markdown files. The @ syntax is only meaningful in interactive prompts.
- **Action:** Remove @ refs from `.claude/templates/checkpoint.md`
- **Migration:** Leave existing files as-is (harmless, not worth mass-edit)
- **Effort:** Small

### [SMALL] E2-134: Session Number from Events Log
- **Status:** proposed
- **Owner:** Hephaestus
- **Created:** 2025-12-22
- **Session:** 100
- **spawned_by:** E2-133 limitation
- **Context:** E2-133 reads current_session from haios-status.json which is derived from checkpoints. If scaffolding before first checkpoint, shows previous session. Could read from `just session-start <N>` event in haios-events.jsonl for accuracy.
- **Effort:** Small

### [SMALL] E2-135: Close Command Enforcement
- **Status:** proposed
- **Owner:** Hephaestus
- **Created:** 2025-12-22
- **Session:** 100
- **spawned_by:** INV-020
- **Milestone:** M5-Plugin
- **Context:** Currently RFC2119 reminders say "MUST use /close" but agent can manually edit backlog.md status to "complete". This bypasses DoD validation.
- **Action:** PreToolUse blocks Edit to backlog.md with "Status: complete" pattern, redirects to /close
- **Pattern:** Blocker → Alternative (L3 enforcement)
- **Effort:** Small

### [SMALL] E2-136: Status Generator Archive Reading
- **Status:** proposed
- **Owner:** Hephaestus
- **Created:** 2025-12-22
- **Session:** 100
- **spawned_by:** INV-020
- **Milestone:** M5-Plugin
- **Context:** Milestone tracking shows phantom items (E2-129, E2-131, E2-116) because status generator doesn't read backlog_archive.md or backlog-complete.md.
- **Action:** Update `_discover_milestones_from_backlog()` in status.py to also check archive locations
- **Fixes:** M4-Research shows 86% instead of 100%, M5-Plugin shows 67% instead of actual
- **Effort:** Small

### [MEDIUM] E2-137: Event Pattern Analyzer
- **Status:** proposed
- **Owner:** Hephaestus
- **Created:** 2025-12-22
- **Session:** 100
- **spawned_by:** INV-020
- **Milestone:** M6-Feedback
- **Context:** RESONANCE logs events but doesn't feed back to DYNAMICS. 20+ events logged, never read.
- **Action:** Create `just analyze-events` recipe that reads haios-events.jsonl, detects anti-patterns (cycle skipping, rapid closures without CHECK), injects warnings
- **Closes:** RESONANCE → DYNAMICS feedback loop (Symphony architecture gap)
- **Effort:** Medium

### [MEDIUM] E2-138: Lifecycle Gate Enforcement
- **Status:** proposed
- **Owner:** Hephaestus
- **Created:** 2025-12-22
- **Session:** 100
- **spawned_by:** INV-020
- **Milestone:** M6-Feedback
- **Context:** Lifecycle guidance suggests /new-investigation before /new-plan but agent can skip with "skip discovery".
- **Action:** PreToolUse blocks /new-plan without prior INVESTIGATION-{id}.md file
- **Promotes:** Lifecycle guidance from L2 suggestion to L3 blocker
- **Effort:** Medium

### [MEDIUM] E2-139: Insight Crystallization Trigger
- **Status:** proposed
- **Owner:** Hephaestus
- **Created:** 2025-12-22
- **Session:** 100
- **spawned_by:** Session 100 operator observation
- **Milestone:** M6-Feedback
- **Context:** Agent stores insights when operator prompts "this should be memory" but doesn't autonomously recognize insight-worthy moments. Mid-session discoveries like "oyster-nacre pattern" require operator intervention.
- **Gap:** Stop hook captures end-of-session learnings, but mid-session insights need different trigger.
- **Proposed Mechanism:** Detect meta-discussion patterns (operator talking about system, not using it) or insight signals ("this is important", "key insight", metaphors) and inject memory prompt.
- **Pattern:** Move from L2 (operator reminds) to L3/L4 (system detects and prompts/captures)
- **Related:** [INV-023, Stop hook, RESONANCE]
- **Effort:** Medium

### [MEDIUM] E2-143: Audit Recipe Suite
- **Status:** pending
- **Priority:** medium
- **Owner:** Hephaestus
- **Created:** 2025-12-23
- **Session:** 101
- **spawned_by:** INV-022
- **Milestone:** M5-Plugin
- **Context:** Session 101 governance audit was manual. Should have recipes to detect drift automatically.
- **Problem:** No automated way to find: status mismatches, implementation gaps, stale investigations
- **Solution:** Add justfile recipes for periodic auditing
- **Deliverables:**
  - [ ] `just audit-sync` - compare investigation file status vs archive
  - [ ] `just audit-gaps` - find backlog items with implementation evidence but still pending
  - [ ] `just audit-stale` - find investigations older than 10 sessions still active
- **Pattern:** Scheduled garbage collection - detect drift before it accumulates
- **Related:** [INV-022, justfile, Session 101 cleanup]
- **Effort:** Medium

---

### [MEDIUM] E2-117: Milestone Auto-Discovery
- **Status:** proposed
- **Owner:** Hephaestus
- **Created:** 2025-12-20
- **Session:** 90
- **Milestone:** M6-WorkCycle
- **Context:** Milestone discovery relies on hardcoded names in status.py. Should auto-discover from work files or backlog without hardcoding.
- **Problem:** Adding M6-WorkCycle required manual edit to status.py milestone_names dict.
- **Root Cause:** `_discover_milestones_from_backlog()` has hardcoded milestone_names dict.
- **Solution:** Parse `**Milestone:**` field from work files/backlog to build milestone list dynamically.
- **Effort:** Small
- **Related:** [E2-120, E2-150, .claude/lib/status.py]

### [MEDIUM] E2-118: Vitals Work Cycle State Injection
- **Status:** proposed
- **Owner:** Hephaestus
- **Created:** 2025-12-20
- **Session:** 91
- **Spawned By:** Session 91 recovery discussion
- **Context:** Vitals show infrastructure (commands, skills, agents) but not operational state. Missing: current session, active work item, cycle type (implementation vs investigation), cycle phase (PLAN/DO/CHECK/DONE).
- **Gap:** E2-097 logs cycle events to events.jsonl but UserPromptSubmit doesn't read them for vitals injection.
- **Proposed Output:**
  ```
  Session: 91 | Phase: DO | Item: E2-118
  Cycle: Implementation (vitals enhancement)
  ```
- **Effort:** Medium
- **Related:** [E2-097, E2-096, E2-119]

### [MEDIUM] E2-119: UpdateHaiosStatus on Every Prompt
- **Status:** proposed
- **Owner:** Hephaestus
- **Created:** 2025-12-20
- **Session:** 91
- **Spawned By:** Session 91 pm.last_session stale bug
- **Context:** UpdateHaiosStatus currently runs on PostToolUse (file edits) or manually. This leaves pm.last_session, session_delta, and metrics stale between edits. Running on UserPromptSubmit ensures freshness on every interaction.
- **Benefit:** Vitals always reflect current state, scaffold commands get correct prior_session
- **Risk:** Performance - UpdateHaiosStatus.ps1 may add latency. Consider caching or lightweight mode.
- **Effort:** Small (hook wiring) + Medium (performance optimization)
- **Related:** [E2-118, ScaffoldTemplate.ps1, E2-120]

### [MEDIUM] E2-124: Synthesis Safety Measures
- **Status:** proposed
- **Owner:** Hephaestus
- **Created:** 2025-12-21
- **Session:** 91
- **Spawned By:** Session 91 cross-pollination discussion
- **Context:** Cross-pollination compares ~99M concept pairs. Need safety measures to prevent corruption and enable recovery.
- **Identified Risks:**
  1. **No backup before synthesis** - Can't rollback if synthesis corrupts data
  2. **Stale strategy propagation** - Old invalidated decisions resurface
  3. **False positive connections** - Unrelated concepts linked
  4. **Echo chamber effect** - Volume-based overweighting
  5. **Coldstart pollution** - Synthesis abstractions crowd out concrete work
  6. **No post-synthesis validation** - Unknown quality of new connections
- **Deliverables:**
  - [ ] `just synthesis-backup` recipe - Copy haios_memory.db before synthesis
  - [ ] `just synthesis-rollback` recipe - Restore from backup
  - [ ] Add `superseded_by` field to concepts for invalidation tracking
  - [ ] Post-synthesis quality report (false positive sampling)
  - [ ] Threshold tuning for similarity cutoffs
  - [ ] Consider: sampling mode (10% of pairs for 90% of value?)
- **Effort:** Medium
- **Related:** [synthesis.py, PLAN-SYNTHESIS-001, Session 91]

### [MEDIUM] E2-127: Bidirectional Doc Automation Investigation
- **Status:** proposed
- **Owner:** Hephaestus
- **Created:** 2025-12-21
- **Session:** 93
- **Spawned By:** Session 93 retrospective
- **Blocked By:** [E2-120] (Phase 3 must complete first)
- **Context:** Currently, governance updates are one-way: manual doc edits -> haios-status.json. No automation updates source docs when events occur.
- **Gap Identified:**
  - Plan progress tracker requires manual table updates
  - Plan checkboxes require manual `[x]` marking
  - Frontmatter status/lifecycle_phase require manual updates
  - Related items not auto-updated when spawned items created
- **Investigation Questions:**
  1. What events should trigger source doc updates?
  2. How to update YAML frontmatter programmatically without breaking format?
  3. How to mark checkboxes in markdown reliably?
  4. Should this be hook-based or explicit command?
  5. Risk of accidental overwrites vs manual control?
- **Potential Deliverables:**
  - `just cascade <id> complete` updates plan frontmatter
  - Checkpoint creation updates related plan's `related` field
  - Test pass events mark corresponding checkboxes
- **Effort:** Medium (investigation + design)
- **Related:** [E2-120, haios-status.json, CascadeHook]

### [LOW] E2-109: Heartbeat Scheduled Task Environment Fix
- **Status:** proposed
- **Owner:** Hephaestus
- **Created:** 2025-12-20
- **Session:** 89
- **Context:** Heartbeat task returns exit code 1 when run by Task Scheduler, but works manually. Root cause: GOOGLE_API_KEY not available in scheduled task context (not loaded from .env). Manual runs work because shell has environment.
- **Symptoms:**
  - Task Status: Ready, Last Result: 1
  - No heartbeat event logged from scheduled runs
  - Manual `just heartbeat` works fine
- **Options:**
  - Set GOOGLE_API_KEY as system environment variable
  - Modify heartbeat recipe to load .env explicitly
  - Create wrapper script that sources environment
- **Effort:** Small
- **Related:** [E2-081, E2-102]

### [MEDIUM] E2-108: Soft Gates for Implementation Cycle
- **Status:** proposed
- **Owner:** Hephaestus
- **Created:** 2025-12-20
- **Session:** 89
- **Spawned By:** Session 89 cycle enforcement analysis
- **Context:** Current cycle enforcement is WEAK (advisory only). Option B preferred: soft gates with observability. Real work involves discussions between phases, bug patches mid-flow, multi-context-refresh cycles.
- **Design Goals:**
  - Guidance over blocking
  - Flag anomalies, don't prevent
  - Support non-linear workflows
  - Scale to complex multi-session work
- **Deliverables:**
  - [ ] preflight-checker returns structured warnings (not blocks)
  - [ ] Events flag "skipped_phase" for non-sequential transitions
  - [ ] `/close` warns if no cycle events exist (can override)
  - [ ] Consider: cycle state persistence across context refreshes
- **Effort:** Medium
- **Related:** [E2-092, E2-093, E2-097, implementation-cycle]

### [HIGH] E2-106: FORESIGHT Preparation - Cycle Prediction Fields
- **Status:** proposed
- **Priority:** high
- **Owner:** Hephaestus
- **Created:** 2025-12-19
- **Session:** 86
- **Spawned By:** Session 86 strategic discussion (Epoch 3 vision review)
- **Milestone:** M3-Cycles
- **Context:** M3-Cycles will generate the data that feeds Epoch 3's FORESIGHT layer. By adding optional prediction/calibration fields NOW, we prepare rich seed data for:
  - **World Model:** predicted_outcome vs actual_outcome calibration
  - **Self Model:** competence_estimate by domain
  - **Goal Network:** knowledge_gaps, skill_gaps as blocking_on precursors
  - **Metamemory:** prediction confidence tracking
- **Philosophy:** Not building FORESIGHT now - preparing the data structure so Epoch 3 has calibration data from real cycles.
- **Deliverables:**
  - [ ] Define `foresight_prep` schema (optional frontmatter section)
  - [ ] Update E2-096 (cycle_phase) with foresight_prep fields
  - [ ] Update E2-091 (implementation-cycle skill) with prediction prompts
  - [ ] Update E2-095 (why-capturer) to also capture prediction accuracy
  - [ ] Update E2-097 (cycle events) to include prediction events
- **Schema:**
  ```yaml
  # PLAN phase captures
  foresight_prep:
    predicted_outcome: "Description of expected result"
    predicted_confidence: 0.75  # 0-1
    knowledge_gaps: ["gap1", "gap2"]
    skill_gaps: ["gap1"]
    competence_domain: "domain_tag"

  # CHECK phase adds
  foresight_prep:
    actual_outcome: "What actually happened"
    prediction_error: 0.2  # delta from prediction (0-1)
    competence_estimate: 0.7  # Self-assessed capability
    failure_modes_discovered: ["mode1"]
  ```
- **Memory:** 72389-72392 (symbiote philosophy), 72401-72406 (strategic decision)
- **Related:** [epoch3/foresight-spec.md, E2-096, E2-091, E2-095, E2-097]

### [ABSORBED] E2-096: Cycle State Frontmatter
- **Status:** absorbed
- **Absorbed By:** E2-150 (Work-Item Infrastructure)
- **Owner:** Hephaestus
- **Created:** 2025-12-17
- **Session:** 83
- **Absorbed Session:** 105
- **Milestone:** M6-WorkCycle
- **Context:** Originally: Add `cycle_state` field to plan frontmatter. Absorbed into E2-150 because work file schema (INV-022 v2) supersedes plan-only cycle_state with full `current_node` + `node_history` tracking.
- **Original Deliverables:** (now covered by E2-150)
  - [ ] Add `cycle_state` to implementation_plan template
  - [ ] Update frontmatter schema
  - [ ] UpdateHaiosStatus tracking
  - [ ] Display cycle state in vitals
- **Related:** [E2-150, INV-022, ADR-039]

### [MEDIUM] E2-098: Hardcode Audit and Enhancement
- **Status:** proposed
- **Owner:** Hephaestus
- **Created:** 2025-12-17
- **Session:** 83
- **Context:** Multiple scripts/hooks have hardcoded values that should be dynamic. Discovered when M3-Cycles milestone caused vitals to show 0% instead of M2's 82%.
- **Known Hardcodes:**
  - [ ] `UserPromptSubmit.ps1`: Vitals milestone selection (first in JSON, not highest progress or most active)
  - [ ] `plan_tree.py`: Was hardcoded to M2-Governance (fixed Session 83)
  - [ ] Others TBD via audit
- **Deliverables:**
  - [ ] Audit all hooks/scripts for hardcoded milestone/backlog references
  - [ ] Enhance vitals to show highest-progress milestone (or user-configurable)
  - [ ] Document dynamic selection logic
- **Effort:** Medium
- **Related:** [E2-082, M3-Cycles]

---

## Milestone: M5-Plugin (Plugin Architecture)

> **Theme:** Transform HAIOS from project-embedded code to a portable Claude Code plugin.
> **Vision:** HAIOS as a distributable governance infrastructure usable in ANY project.
> **Trigger:** Session 91 operator decision - ".claude is the safest space for plugin centric stuff"
> **Status:** Foundation complete. Distribution pending.

**Architecture (Achieved):**
```
.claude/
├── .claude-plugin/plugin.json  ✓
├── commands/                   ✓ 15 commands
├── agents/                     ✓ 4 agents
├── skills/                     ✓ 4 skills
├── hooks/                      ✓ Python dispatcher
├── templates/                  ✓ 7 templates
└── lib/                        ✓ All Python code (322 tests)
```

**Core Items:**
- E2-120: Plugin Architecture Migration - **CLOSED** (Session 94)
- E2-121: haios_etl → .claude/lib migration - **Subsumed** by E2-120
- E2-122: Plugin distribution - **DEFERRED** (private copy approach sufficient; private repo possible future)
- E2-123: CLI-agnostic interface layer (TBD) - Future

**Distribution Note (E2-122):** `.claude/` folder is self-contained. For private use:
```bash
cp -r ~/projects/haios/.claude ~/projects/other-project/
```
Future: Private GitHub repo if remote access needed. No public distribution planned.

**Spawned Items:**
- E2-125: Full Status Module - **COMPLETE** (17 functions, 36 tests, Session 94)
- E2-126: Frontmatter Timestamp Migration - **COMPLETE** (22 files, Session 94)
- E2-127: Bidirectional Doc Automation - MEDIUM (unblocked)
- E2-128: Checkpoint Git Integration - LOW (enhance checkpoint workflow)
- E2-131: Cascade Module Migration - **COMPLETE** (Session 97)

### [COMPLETE] E2-131: Cascade Module Python Migration
- **Status:** complete
- **Owner:** Hephaestus
- **Created:** 2025-12-22
- **Completed:** 2025-12-22
- **Session:** 97
- **Milestone:** M5-Plugin
- **Spawned By:** E2-120 (discovered during Session 97 review)
- **Context:** CascadeHook.ps1 was archived by E2-120 but no Python equivalent created. justfile `cascade` recipe was broken.
- **Results:**
  - [x] `.claude/lib/cascade.py` - 5 cascade types, ~350 LOC
  - [x] Updated justfile `cascade` recipe to call Python
  - [x] 20 tests in `tests/test_lib_cascade.py`
  - [x] 365 total tests passing (up from 345)
- **Effort:** ~30 minutes (actual)
- **Related:** [E2-120, E2-076e]

### [LOW] E2-128: Checkpoint Git Integration
- **Status:** proposed
- **Owner:** Hephaestus
- **Created:** 2025-12-21
- **Session:** 94
- **Milestone:** M5-Plugin
- **Context:** Session 94 revealed 60 sessions without git commit. Manual git discipline unreliable. Checkpoint workflow should include git save.
- **Problem:** Git output is verbose (status, diff, log), fills main context. Session 94 commit of 348 files consumed significant context.
- **Solution:** Create `git-checkpoint` subagent that:
  1. Runs git status/diff/add/commit in isolated context
  2. Returns concise summary (commit hash, file count, 1-2 line description)
  3. Invoked automatically by `/new-checkpoint` skill
- **Workflow:**
  ```
  /new-checkpoint → scaffold → populate → git-checkpoint agent → commit
                                              ↓
                                         Returns: "12f5e7e: Session 94 (23 files)"
  ```
- **Implementation Options:**
  | Option | Effort | Notes |
  |--------|--------|-------|
  | A. Subagent only | Low | Manual invocation after checkpoint |
  | B. Skill enhancement | Medium | /new-checkpoint calls agent automatically |
  | C. Hook-based | Medium | PostToolUse triggers on checkpoint completion |
- **Recommended:** Option B - skill enhancement
- **Effort:** Medium (1 session)
- **Related:** [E2-035 (Checkpoint Lifecycle), /new-checkpoint command]

### [LOW] INV-021: Work Item Taxonomy and Schema Semantics
- **Status:** proposed
- **Owner:** Hephaestus
- **Created:** 2025-12-21
- **Session:** 95
- **Type:** Research/Investigation
- **Context:** HAIOS uses fields like `status`, `lifecycle_phase`, `milestone`, `category` but lacks formal taxonomy. Session 95 identified need to categorize "interrupt" work (E2-130) vs milestone work.
- **Design Principle:** Use industry-standard Agile/PMBOK terminology so LLMs can leverage existing training data without fine-tuning on HAIOS-specific vocabulary.
- **Questions to Answer:**
  - What fields should backlog items have? (status, category, priority, effort, etc.)
  - What are the valid values for each field?
  - Which terms are industry-standard? (sprint, tech-debt, spike, epic, story, DoD)
  - How to categorize non-milestone work? (interrupt, maintenance, hygiene, hotfix)
- **Deliverables:**
  - [ ] Field taxonomy document
  - [ ] Schema definition for work items
  - [ ] ADR for terminology choices
- **Related:** [E2-130, ADR-033, ADR-034]

### [HIGH] INV-023: ReasoningBank Feedback Loop Architecture
- **Status:** active
- **Owner:** Hephaestus
- **Created:** 2025-12-22
- **Session:** 98
- **Type:** Research/Investigation
- **Spawned By:** Session 98 observation during E2-113 planning
- **Milestone:** M4-Research
- **Context:** ReasoningBank is write-heavy, read-weak. Memory retrieval works but no feedback loop exists. Agent queries memory, gets results, but: (1) strategies returned are often meta/generic, (2) no mechanism to reinforce "this was useful", (3) learned discounting - agent skims results due to low signal-to-noise.
- **Core Problem:** Embedding similarity ≠ task relevance. No click-through equivalent - system can't learn what was helpful.
- **Hypotheses:**
  - H1: Agent has learned to discount memory results due to low signal-to-noise
  - H2: Strategies returned are meta/generic rather than task-specific
  - H3: Explicit feedback would improve retrieval over time
  - H4: Implicit signals (references in output) could substitute for explicit feedback
- **Investigation:** `docs/investigations/INVESTIGATION-INV-023-reasoningbank-feedback-loop-architecture.md`
- **Phase 1 Complete:** Problem documented, epistemic_state updated
- **Related:** [INV-020, ADR-037, E2-083]

### [LOW] INV-019: Requirements Synthesis from Memory
- **Status:** proposed
- **Owner:** Hephaestus
- **Created:** 2025-12-21
- **Session:** 94
- **Type:** Research/Investigation
- **Context:** Session 94 discussion identified gap in epistemic state: HAIOS has extensive HOW documentation (TRDs, plans, ADRs) but lacks formal WHAT/WHY requirements specification.
- **Opportunity:** 77,000+ memory concepts contain implicit requirements. 94 sessions of checkpoints show recurring patterns. ADRs contain decision rationale that implies requirements.
- **Potential Value:**
  - Grounded prioritization (trace work items to requirements)
  - Testable success criteria (requirements are verifiable)
  - Scope drift detection (clear boundary of what's in/out)
  - Cross-session coherence (requirements persist; context compacts)
- **Approach:**
  - Query memory: "decisions and rationale for HAIOS capabilities, what the system must do, operator needs"
  - Extract implicit requirements from ADRs, vision docs, recurring pain points
  - Formalize into Requirements Specification (R-001, R-002, etc.)
- **Deliverables:**
  - [ ] Memory synthesis query for implicit requirements
  - [ ] Draft Requirements Specification document
  - [ ] Trace existing work items to requirements
- **Effort:** Medium (investigation) + Medium (documentation)
- **Related:** [epistemic_state.md, ADRs, Session 94 discussion]

### [LOW] E2-152: Work-Item Tooling Cutover
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-23
- **Session:** 105
- **spawned_by:** INV-024
- **blocked_by:** [E2-151]
- **Milestone:** M6-WorkCycle
- **Context:** Phase A.3 of Work-Item-as-File migration. Update existing tooling to use work files.
- **Deliverables:**
  - [ ] Update `/close` to modify work file status, move to archive/
  - [ ] Update cascade to scan work files for blocked_by
  - [ ] Update status generator to read from docs/work/
  - [ ] Add PreToolUse warning for backlog.md writes
- **Effort:** Medium
- **Related:** [ADR-039, E2-151]

### [LOW] E2-153: Unified Metaphor Section in ARCHITECTURE.md
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-23
- **Session:** 105
- **spawned_by:** INV-026
- **blocked_by:** [E2-155]
- **Milestone:** M6-WorkCycle
- **Context:** Phase C (FINAL). INV-026 produced 3-layer architecture mapping (Symphony→Cycles→DAG). Documentation done LAST since implementation may adjust design.
- **Deliverables:**
  - [ ] Add "Three-Layer Architecture" section to `.claude/REFS/ARCHITECTURE.md`
  - [ ] Include mapping table and diagram from INV-026
  - [ ] Reference ADR-038, INV-022, INV-024
- **Effort:** Low
- **Related:** [INV-026, ADR-038, INV-022]

### [MEDIUM] E2-154: Scaffold-on-Entry Hook (INV-022 Phase 2)
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-23
- **Session:** 105
- **spawned_by:** INV-026
- **blocked_by:** [E2-152]
- **Milestone:** M6-WorkCycle
- **Context:** Phase B.1 - DAG Automation. Implement PostToolUse mechanism from INV-022 to scaffold cycle docs on node entry.
- **Deliverables:**
  - [ ] Detect `current_node` field changes in work files
  - [ ] Look up node-cycle binding configuration
  - [ ] Scaffold cycle docs via /new-* commands
  - [ ] Update work file `cycle_docs` field
- **Effort:** High
- **Related:** [INV-022, INV-026, E2-152]

### [MEDIUM] E2-155: Node Exit Gates (INV-022 Phase 2)
- **Status:** pending
- **Owner:** Hephaestus
- **Created:** 2025-12-23
- **Session:** 105
- **spawned_by:** INV-026
- **blocked_by:** [E2-154]
- **Milestone:** M6-WorkCycle
- **Context:** Phase B.2 - DAG Automation. Implement PreToolUse mechanism from INV-022 to block node transitions until criteria met.
- **Deliverables:**
  - [ ] Gate `current_node` field changes
  - [ ] Look up exit criteria for current node's cycle
  - [ ] Verify all criteria met before allowing transition
  - [ ] Provide actionable error messages on failure
- **Effort:** High
- **Related:** [INV-022, INV-026, E2-154]

---

## Archive Reference
Completed items moved to `docs/pm/archive/` with completion date.
